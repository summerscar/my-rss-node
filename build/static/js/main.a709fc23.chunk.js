(this["webpackJsonpmy-rss-mobile"]=this["webpackJsonpmy-rss-mobile"]||[]).push([[0],{113:function(e,t,a){e.exports=a(216)},118:function(e,t,a){},182:function(e,t,a){},216:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),l=a.n(c),o=(a(118),a(119),a(100)),i=a.n(o),s=(a(164),a(101)),u=a.n(s),m=(a(178),a(66)),d=a.n(m),h=(a(88),a(16)),f=a.n(h),p=a(72),v=a(11),g=(a(182),a(62),a(20)),E=a.n(g),b=(a(64),a(36)),y=a.n(b),j=a(19),k=a(26),O=a(14),w=a(29),S=a.n(w),N=a(67),x=a.n(N),C=a(104),I=a(105),A=(a(188),a(68)),_=a.n(A),P=(a(193),a(107)),z=a.n(P),T=a(109),H=a.n(T).a.create();H.interceptors.request.use((function(e){return localStorage.getItem("useAuth:expires_at")&&(new Date).getTime()<localStorage.getItem("useAuth:expires_at")?(e.headers.Authorization="Bearer "+localStorage.getItem("accessToken"),e):(localStorage.removeItem("accessToken"),e)}),(function(e){return Promise.reject(e)})),H.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&z.a.info("\u9700\u8981\u767b\u5f55\u54e6"),Promise.reject(e)}));var W=H,D=a(39),R=a(69),L=r.a.createContext({}),Y=_.a.Item;var M=Object(k.h)((function(e){var t=e.videos,a=Object(I.a)(e,["videos"]),c=Object(n.useContext)(L),l=c.user,o=c.ytbPlayer,i=c.channel,s=c.setData,u=Object(k.f)(),m=Object(n.useState)(""),d=Object(v.a)(m,2),h=d[0],f=d[1],p=Object(k.g)().id,g=Object(n.useState)(u.state&&u.state.data),b=Object(v.a)(g,2),w=b[0],N=b[1],A=Object(n.useState)(!1),P=Object(v.a)(A,2),z=P[0],T=P[1],H=Object(n.useState)(!1),D=Object(v.a)(H,2),R=D[0],M=D[1],F=Object(n.useState)(!1),V=Object(v.a)(F,2),B=V[0],U=V[1],q=Object(n.useState)(""),G=Object(v.a)(q,2),J=G[0],X=G[1],$=Object(n.useState)(!1),K=Object(v.a)($,2),Q=K[0],Z=K[1],ee=Object(O.b)(),te=ee.userId,ae=ee.isAuthenticated,ne=ee.login;console.log("videos",a.videos);var re=l&&(l["https://dev-ymyh-0n9:auth0:com/user_metadata"]&&l["https://dev-ymyh-0n9:auth0:com/user_metadata"].likes||l.user_metadata&&l.user_metadata.likes),ce=Object(n.useRef)(0);Object(n.useEffect)((function(){ce.current&&ce.current!==p&&(f(""),X(""),N(null)),ce.current=p,w||W.get("/api/auth/videoSearch/".concat(p)).then((function(e){N(e.data),console.log("setvodedata",w)})).catch((function(e){console.log(e)}))}),[w,p]);var le=Object(n.useRef)();Object(n.useEffect)((function(){if(le.current&&"true"===localStorage.getItem("sequencePlay")){var e=function(){var e=Object(C.a)(x.a.mark((function e(){var t,n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.post("/api/auth/videoPrev",{name:i,isodate:w.isodate});case 2:t=e.sent,n=t.data,a.history.push("/video/".concat(n.id));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=le.current;return t.addEventListener("ended",e),function(){return t.removeEventListener("ended",e)}}}),[w]);var oe=r.a.createElement(r.a.Fragment,null,r.a.createElement(Y,{key:"0"},"\u6062\u590d"),r.a.createElement(Y,{key:"8"},"\u4e00\u822c\u5411\u3051"),r.a.createElement(Y,{key:"1"},"\u5c0f\u5b661\u5e74\u751f"),r.a.createElement(Y,{key:"2"},"\u5c0f\u5b662\u5e74\u751f"),r.a.createElement(Y,{key:"3"},"\u5c0f\u5b663\u5e74\u751f"),r.a.createElement(Y,{key:"4"},"\u5c0f\u5b664\u5e74\u751f"),r.a.createElement(Y,{key:"5"},"\u5c0f\u5b665\u5e74\u751f"),r.a.createElement(Y,{key:"6"},"\u5c0f\u5b666\u5e74\u751f"),r.a.createElement(Y,{key:"7"},"\u5c0f\u5b667\u5e74\u751f"));return r.a.createElement("div",{className:"videoWrapper"},w?r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",null,!o&&w.url?r.a.createElement("video",{ref:le,src:w.url,width:"100%",controls:!0,autoPlay:!0}):r.a.createElement("iframe",{src:"https://www.youtube.com/embed/".concat(new URL(w.link).searchParams.get("v")),style:{width:"100vw",height:"calc(9 / 16 * 100vw)"},title:w.title,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})),r.a.createElement("div",{className:"contentWrapper"},r.a.createElement("div",{style:{fontSize:"14px",fontWeight:"bold",padding:"0.5rem 0"}},w.title),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(E.a,{size:"small",onClick:function(){U(!0),W.post("/api/auth/like",{id:w.id,userId:te,title:w.title}).then((function(e){s("user",e.data),U(!1)})).catch((function(e){console.log(e),U(!1)}))},loading:B,inline:!0},re&&re.find((function(e){return e.id===w.id}))?"\u5df2\u6536\u85cf":"\u6536\u85cf"),r.a.createElement(E.a,{size:"small",style:{marginLeft:"0.4rem"},onClick:function(){T(!0),W.post("/api/auth/translate",{content:w.contentsnippet}).then((function(e){f(e.data.result),T(!1)})).catch((function(e){console.log(e),T(!1)}))},loading:z,inline:!0},"\u7ffb\u8bd1"),r.a.createElement(_.a,{overlayClassName:"fortest",overlayStyle:{color:"currentColor"},visible:Q,overlay:oe,align:{overflow:{adjustY:0,adjustX:0},offset:[-10,0]},onVisibleChange:function(){return Z(!Q)},onSelect:function(e){var t;"0"!==(t=e.key)?(M(!0),W.post("/api/auth/furigana",{content:w.contentsnippet.replace(/<br>/g,"\n"),grade:t}).then((function(e){X(e.data.WordList.Word.map((function(e,t){return e.Surface._cdata?"\n":r.a.createElement("ruby",{key:t},e.Surface._text,e.Furigana?r.a.createElement(r.a.Fragment,null,r.a.createElement("rp",null,"("),r.a.createElement("rt",null,e.Furigana._text),r.a.createElement("rp",null,")")):null)}))),M(!1)})).catch((function(e){console.log(e),M(!1)}))):X(null),Z(!Q)}},r.a.createElement(E.a,{size:"small",style:{marginLeft:"0.4rem"},loading:R,inline:!0},"\u632f\u308a\u4eee\u540d"))),r.a.createElement("div",{style:{fontSize:"12px",lineHeight:"30px"}},S()(w.pubdate).format("MM/DD HH:mm"))),r.a.createElement("div",{style:{paddingTop:"1rem",lineHeight:"1.5",whiteSpace:"pre-wrap"}},J||w.contentsnippet.replace(/<br>/g,"\n")),r.a.createElement("div",{style:{paddingTop:"1rem",whiteSpace:"pre-wrap",lineHeight:"1.3",color:"rgb(58, 58, 58)"}},h.replace(/<br><br>/g,"<br>").replace(/<br>/g,"\n"))),r.a.createElement("div",{className:"footer",style:{textAlign:"center"}},"News by ",r.a.createElement("a",{href:"https://github.com/summerscar/my-rss-node"},"summerscar"))):r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"loading"},r.a.createElement(y.a,{size:"large"}),r.a.createElement("span",null,"\u7a0d\u7b49\u4e00\u4e0b\u54e6"))),r.a.createElement("div",{className:"listwrapper"},t.length?t.map((function(e,t){return r.a.createElement("div",{key:t,className:"videoItem ".concat(Number(p)===e.id?"activity":"")},r.a.createElement(j.b,{className:"link",to:{pathname:"/video/"+e.id,state:{data:e}}},r.a.createElement("div",null,r.a.createElement("img",{alt:"video",src:"/image/".concat(i,".jpg")})),e.title,r.a.createElement("div",{style:{fontSize:"12px"}},S()(e.pubdate).format("YYYY/MM/DD HH:mm"))))})):null,r.a.createElement("i",{className:"video"}),r.a.createElement("i",{className:"video"}),r.a.createElement("i",{className:"video"}),r.a.createElement("i",{className:"video"}),r.a.createElement("i",{className:"video"}),t.length>0&&r.a.createElement(E.a,{style:{width:"100%"},size:"small",onClick:ae()?a.more:ne,loading:z},"\u66f4\u591a")))}));var F=function(e){var t=Object(O.b)(),a=t.isAuthenticated,c=t.login,l=e.videos,o=e.isloading,i=Object(n.useRef)([]),s=Object(n.useContext)(L).channel;return r.a.createElement("div",{className:"homeWrapper"},l.length?l.map((function(e,t){return r.a.createElement("div",{key:t,className:"videoItem"},r.a.createElement("div",null,r.a.createElement("video",{ref:function(e){return i.current[t]=e},className:"videoRadius",src:e.url,width:"100%",controls:!0,preload:"none",poster:"/image/".concat(s,".jpg")})),r.a.createElement(j.b,{className:"link",to:{pathname:"/video/"+e.id,state:{data:e}},onClick:function(){return e.id,e.title,void i.current.forEach((function(e){return e.pause()}))}},e.title,r.a.createElement("div",{style:{fontSize:"12px"}},S()(e.pubdate).format("YYYY/MM/DD HH:mm"))))})):o?r.a.createElement("div",{className:"loading"},r.a.createElement(y.a,{size:"large"}),r.a.createElement("span",null,"\u7a0d\u7b49\u4e00\u4e0b\u54e6")):null,l.length>0&&r.a.createElement(E.a,{size:"small",onClick:a()?e.more:c,loading:o},"\u66f4\u591a"),r.a.createElement(k.a,{path:"/video/:id"},r.a.createElement(M,{videos:l,more:e.more})))},V=f.a.Item;var B=Object(k.h)((function(e){var t=Object(n.useContext)(L).user,a=t&&(t["https://dev-ymyh-0n9:auth0:com/user_metadata"]&&t["https://dev-ymyh-0n9:auth0:com/user_metadata"].likes||t.user_metadata&&t.user_metadata.likes);return r.a.createElement("div",{className:"likes"},r.a.createElement("div",{style:{textAlign:"center",fontSize:"20px",padding:"1rem"}},"\u6536\u85cf\u5939"),r.a.createElement(f.a,{style:{margin:"0 1rem"}},a&&a.map((function(t,a){return r.a.createElement(V,{key:a,onClick:function(){return e.history.push("/video/"+t.id)}},S()(t.time).format("MM/DD HH:mm")+" "+t.title)}))))})),U=(a(213),a(112)),q=a.n(U),G=(a(63),a(46)),J=a.n(G),X=function(){var e=Object(O.b)(),t=e.isAuthenticated,a=e.login,c=e.authResult,l=e.user,o=Object(n.useContext)(L).setData;return console.log("user: ",c),Object(n.useEffect)((function(){o("user",l)}),[l]),t()?r.a.createElement("div",null,c&&(c.idTokenPayload.picture?r.a.createElement("img",{style:{marginRight:"0.5rem"},width:"20px",src:c.idTokenPayload.picture,alt:c.idTokenPayload.name}):r.a.createElement("span",{style:{paddingRight:"0.5rem"}},c.idTokenPayload.name)),r.a.createElement(y.a,{animating:!c})):r.a.createElement(E.a,{onClick:a,size:"small"},"\u767b\u5f55")},$=Object(k.h)((function(e){var t=Object(k.f)(),a=Object(n.useContext)(L),c=a.channel,l=a.channels;return console.log(c),r.a.createElement(q.a,{mode:"dark",icon:"/"===t.pathname?r.a.createElement(J.a,{key:"1",type:"ellipsis"}):r.a.createElement((function(){return r.a.createElement("svg",{t:"1583392599756",className:"am-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2188",width:"32",height:"32"},r.a.createElement("path",{d:"M513.51198025 140.75069629l372.29605926 340.31186173c-18.95790618 2.32612345-36.75275062 10.11863704-50.9421037 22.56339754l-0.23261236 0.23261234-0.23261234 0.23261235c-13.7241284 12.21214816-30.00699261 33.72879011-30.00699258 67.57388642v316.934321H668.08288395V753.91683951c0-50.59318519-41.87022222-91.6492642-93.3938568-91.6492642H451.86970864c-51.52363457 0-93.39385678 41.17238519-93.39385679 91.6492642v134.56624197H223.79330373v-317.51585185c0-46.52246913-35.47338271-85.13611852-81.29801485-90.95142717l371.01669137-339.26510617m0-75.3664c-13.02629136 0-26.05258271 4.41963457-35.35707655 13.14259753L49.79926913 470.12977778c-15.35241481 13.14259754-19.77204938 32.91464691-11.51431111 50.9421037 8.25773827 17.5622321 25.81997038 27.91348148 46.05724444 27.91348148h46.05724444c13.14259754 0 23.61015309 9.88602469 23.6101531 21.86556049V912.09323457c0 25.23843951 22.44709136 46.05724444 49.89534815 46.05724444h174.45925924c27.44825678 0 49.89534815-20.81880494 49.89534816-46.05724444V753.91683951c0-12.09584198 10.46755556-21.86556049 23.61015309-21.8655605h122.81931851c13.14259754 0 23.61015309 9.88602469 23.6101531 21.8655605v158.29270123c0 25.23843951 22.44709136 46.05724444 50.47687901 46.05724445h174.45925926c28.02978766 0 51.05840989-20.81880494 51.05840988-46.05724445v-340.77708641c0-6.51314566 1.62828642-10.93278025 6.62945185-15.35241482 4.41963457-3.83810371 10.46755556-6.047921 16.98070124-6.047921H941.16977777c20.35358025 0 37.79950618-10.93278025 46.05724446-27.91348147 9.30449382-18.02745678 4.88485926-38.38103704-9.30449384-51.52363458L548.98536296 78.52689382c-9.30449382-8.72296296-22.44709136-13.14259754-35.47338271-13.14259753z",fill:"#ffffff","p-id":"2189"}))}),null),onLeftClick:"/"===t.pathname?e.openDock:function(){return e.history.push("/")},rightContent:[r.a.createElement(X,{key:"0"})]},r.a.createElement("div",null,l.find((function(e){return e.value===c})).label))})),K=function(){var e=Object(O.b)().handleAuthentication;return Object(n.useEffect)((function(){e()}),[e]),r.a.createElement("h1",null,"This is the auth callback page, you should be redirected immediately.")};var Q=Object(k.h)((function(e){var t=Object(n.useState)([]),a=Object(v.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(0),s=Object(v.a)(o,2),m=s[0],h=s[1],g=Object(n.useState)(!1),E=Object(v.a)(g,2),b=E[0],y=E[1],j=Object(O.b)(),w=j.authResult,S=j.isAuthenticated,N=j.logout,x=j.login,C=Object(n.useState)(!1),I=Object(v.a)(C,2),A=I[0],_=I[1],P=Object(n.useState)("true"===localStorage.getItem("sequencePlay")),z=Object(v.a)(P,2),T=z[0],H=z[1],D=Object(n.useContext)(L),R=D.ytbPlayer,Y=D.setData,M=D.channels,V=D.channel;Object(n.useEffect)((function(){S()?(y(!0),W.get("/api/auth/youtube/".concat(V,"?offset=").concat(m)).then((function(e){console.log(e.data),l((function(t){return[].concat(Object(p.a)(t),Object(p.a)(e.data.items))})),y(!1)}))):w||(y(!0),W.get("/api/youtube/".concat(V)).then((function(e){console.log(e.data),l(e.data.items),y(!1)})))}),[m,V]),Object(n.useEffect)((function(){w&&localStorage.setItem("accessToken",w.accessToken)}),[w]);var U=r.a.createElement(f.a,null,!S()&&r.a.createElement(f.a.Item,{onClick:x},"\u767b\u5f55"),r.a.createElement(f.a.Item,{onClick:function(){e.history.push("/likes"),_(!1)}},"\u6536\u85cf\u5939"),r.a.createElement(f.a.Item,{extra:r.a.createElement(d.a,{color:"#108ee9",checked:T,onChange:function(){H(!T),localStorage.setItem("sequencePlay",!T)}})},"\u8fde\u7eed\u64ad\u653e"),r.a.createElement(f.a.Item,{extra:r.a.createElement(d.a,{color:"#108ee9",checked:R,onChange:function(){Y("ytbPlayer",!R),localStorage.setItem("ytbPlayer",!R)}})},"Youtube\u64ad\u653e\u5668"),r.a.createElement(u.a,{data:M,cols:1,value:[V],onChange:function(e){e=e[0],Y("channel",e),localStorage.setItem("channel",e),l([]),h(0)}},r.a.createElement(f.a.Item,{arrow:"horizontal"},"\u5207\u6362\u9891\u9053")),S()&&r.a.createElement(f.a.Item,{onClick:function(){localStorage.removeItem("accessToken"),N()}},"\u6ce8\u9500"));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"layout"},r.a.createElement($,{openDock:function(){return _((function(e){return!e}))}}),r.a.createElement(i.a,{children:r.a.createElement(r.a.Fragment,null),className:"my-drawer",style:{pointerEvents:A?"auto":"none"},contentStyle:{color:"#A6A6A6",textAlign:"center",paddingTop:42},sidebar:U,open:A,onOpenChange:function(){return _((function(e){return!e}))}}),r.a.createElement("div",{className:"indexWrapper"},r.a.createElement(k.c,null,r.a.createElement(k.a,{path:"/likes"},r.a.createElement(B,null)),r.a.createElement(k.a,{path:"/"},r.a.createElement(F,{videos:c,more:function(){return h((function(e){return e+4}))},isloading:b})))),r.a.createElement("div",{className:"footer",style:{textAlign:"center"}},"News by ",r.a.createElement("a",{href:"https://github.com/summerscar/my-rss-node"},"summerscar"))),r.a.createElement(k.a,{path:"/auth0_callback",component:K}))})),Z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ee(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var te=Object(k.h)((function(e){return r.a.createElement(O.a,{navigate:e.history.push,auth0_domain:"dev-ymyh-0n9.auth0.com",auth0_client_id:"U9Ypez6umr0NvVSRxPfcTwEgj8WGIz6p",auth0_language:"zh",auth0_params:{scope:"openid profile email read:current_user update:current_user_metadata create:current_user_metadata"}},r.a.createElement(Q,null))}));l.a.render(r.a.createElement(j.a,null,r.a.createElement((function(e){var t=e.children,a={root:{text:"hello context"},user:null,ytbPlayer:"true"===localStorage.getItem("ytbPlayer")||!1,channels:[{value:"ANNnewsCH",label:"ANN NEWS"},{value:"maidigitv",label:"MAiDiGiTV"}],channel:localStorage.getItem("channel")||"ANNnewsCH",setData:function(e,t){i((function(a){return Object(R.a)({},a,Object(D.a)({},e,t))}))},addStore:function(e,t){i((function(a){return Object(R.a)({},a,Object(D.a)({},e,t))}))}},c=Object(n.useState)(a),l=Object(v.a)(c,2),o=l[0],i=l[1];return r.a.createElement(L.Provider,{value:o},t)}),null,r.a.createElement(te,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ee(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ee(t,e)}))}}()}},[[113,1,2]]]);
//# sourceMappingURL=main.a709fc23.chunk.js.map