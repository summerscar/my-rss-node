(this["webpackJsonpmy-rss-mobile"]=this["webpackJsonpmy-rss-mobile"]||[]).push([[0],{112:function(e,t,a){e.exports=a(215)},117:function(e,t,a){},181:function(e,t,a){},215:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),l=a.n(c),o=(a(117),a(118),a(100)),i=a.n(o),s=(a(163),a(101)),u=a.n(s),m=(a(177),a(66)),d=a.n(m),h=(a(88),a(16)),f=a.n(h),p=a(72),g=a(11),v=(a(181),a(62),a(24)),b=a.n(v),E=(a(64),a(35)),y=a.n(E),j=a(23),k=a(25),O=a(14),w=a(36),S=a.n(w),x=a(67),C=a.n(x),N=a(104),I=(a(187),a(68)),_=a.n(I),A=(a(192),a(106)),P=a.n(A),T=a(108),W=a.n(T).a.create();W.interceptors.request.use((function(e){return localStorage.getItem("useAuth:expires_at")&&(new Date).getTime()<localStorage.getItem("useAuth:expires_at")?(e.headers.Authorization="Bearer "+localStorage.getItem("accessToken"),e):(localStorage.removeItem("accessToken"),e)}),(function(e){return Promise.reject(e)})),W.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&P.a.info("\u9700\u8981\u767b\u5f55\u54e6"),Promise.reject(e)}));var z=W,H=a(39),D=a(69),R=r.a.createContext({}),L=_.a.Item;var M=Object(k.h)((function(e){var t=Object(n.useContext)(R),a=t.user,c=t.ytbPlayer,l=t.channel,o=t.setData,i=Object(k.f)(),s=Object(n.useState)(""),u=Object(g.a)(s,2),m=u[0],d=u[1],h=Object(k.g)().id,f=Object(n.useState)(i.state&&i.state.data),p=Object(g.a)(f,2),v=p[0],E=p[1],j=Object(n.useState)(!1),w=Object(g.a)(j,2),x=w[0],I=w[1],A=Object(n.useState)(!1),P=Object(g.a)(A,2),T=P[0],W=P[1],H=Object(n.useState)(!1),D=Object(g.a)(H,2),M=D[0],Y=D[1],F=Object(n.useState)(""),V=Object(g.a)(F,2),B=V[0],U=V[1],q=Object(n.useState)(!1),G=Object(g.a)(q,2),J=G[0],X=G[1],$=Object(O.b)().userId,K=a&&(a["https://dev-ymyh-0n9:auth0:com/user_metadata"]&&a["https://dev-ymyh-0n9:auth0:com/user_metadata"].likes||a.user_metadata&&a.user_metadata.likes),Q=Object(n.useRef)(0);Object(n.useEffect)((function(){Q.current&&Q.current!==h&&(d(""),U(""),E(null)),Q.current=h,v||z.get("/api/auth/videoSearch/".concat(h)).then((function(e){E(e.data),console.log("setvodedata",v)})).catch((function(e){console.log(e)}))}),[v,h]);var Z=Object(n.useRef)();Object(n.useEffect)((function(){if(Z.current&&"true"===localStorage.getItem("sequencePlay")){var t=function(){var t=Object(N.a)(C.a.mark((function t(){var a,n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z.post("/api/auth/videoPrev",{name:l,isodate:v.isodate});case 2:a=t.sent,n=a.data,e.history.push("/video/".concat(n.id));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),a=Z.current;return a.addEventListener("ended",t),function(){return a.removeEventListener("ended",t)}}}),[v]);var ee=r.a.createElement(r.a.Fragment,null,r.a.createElement(L,{key:"0"},"\u6062\u590d"),r.a.createElement(L,{key:"8"},"\u4e00\u822c\u5411\u3051"),r.a.createElement(L,{key:"1"},"\u5c0f\u5b661\u5e74\u751f"),r.a.createElement(L,{key:"2"},"\u5c0f\u5b662\u5e74\u751f"),r.a.createElement(L,{key:"3"},"\u5c0f\u5b663\u5e74\u751f"),r.a.createElement(L,{key:"4"},"\u5c0f\u5b664\u5e74\u751f"),r.a.createElement(L,{key:"5"},"\u5c0f\u5b665\u5e74\u751f"),r.a.createElement(L,{key:"6"},"\u5c0f\u5b666\u5e74\u751f"),r.a.createElement(L,{key:"7"},"\u5c0f\u5b667\u5e74\u751f"));return v?r.a.createElement("div",{className:"videoWrapper"},r.a.createElement("div",null,!c&&v.url?r.a.createElement("video",{ref:Z,src:v.url,width:"100%",controls:!0,autoPlay:!0}):r.a.createElement("iframe",{src:"https://www.youtube.com/embed/".concat(new URL(v.link).searchParams.get("v")),style:{width:"100vw",height:"calc(9 / 16 * 100vw)"},title:v.title,frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0})),r.a.createElement("div",{className:"contentWrapper"},r.a.createElement("div",{style:{fontSize:"14px",fontWeight:"bold",padding:"0.5rem 0"}},v.title),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(b.a,{size:"small",onClick:function(){Y(!0),z.post("/api/auth/like",{id:v.id,userId:$,title:v.title}).then((function(e){o("user",e.data),Y(!1)})).catch((function(e){console.log(e),Y(!1)}))},loading:M,inline:!0},K&&K.find((function(e){return e.id===v.id}))?"\u5df2\u6536\u85cf":"\u6536\u85cf"),r.a.createElement(b.a,{size:"small",style:{marginLeft:"0.4rem"},onClick:function(){I(!0),z.post("/api/auth/translate",{content:v.contentsnippet}).then((function(e){d(e.data.result),I(!1)})).catch((function(e){console.log(e),I(!1)}))},loading:x,inline:!0},"\u7ffb\u8bd1"),r.a.createElement(_.a,{overlayClassName:"fortest",overlayStyle:{color:"currentColor"},visible:J,overlay:ee,align:{overflow:{adjustY:0,adjustX:0},offset:[-10,0]},onVisibleChange:function(){return X(!J)},onSelect:function(e){var t;"0"!==(t=e.key)?(W(!0),z.post("/api/auth/furigana",{content:v.contentsnippet.replace(/<br>/g,"\n"),grade:t}).then((function(e){U(e.data.WordList.Word.map((function(e,t){return e.Surface._cdata?"\n":r.a.createElement("ruby",{key:t},e.Surface._text,e.Furigana?r.a.createElement(r.a.Fragment,null,r.a.createElement("rp",null,"("),r.a.createElement("rt",null,e.Furigana._text),r.a.createElement("rp",null,")")):null)}))),W(!1)})).catch((function(e){console.log(e),W(!1)}))):U(null),X(!J)}},r.a.createElement(b.a,{size:"small",style:{marginLeft:"0.4rem"},loading:T,inline:!0},"\u632f\u308a\u4eee\u540d"))),r.a.createElement("div",{style:{fontSize:"12px",lineHeight:"30px"}},S()(v.pubdate).format("MM/DD HH:mm"))),r.a.createElement("div",{style:{paddingTop:"1rem",lineHeight:"1.5",whiteSpace:"pre-wrap"}},B||v.contentsnippet.replace(/<br>/g,"\n")),r.a.createElement("div",{style:{paddingTop:"1rem",whiteSpace:"pre-wrap",lineHeight:"1.3",color:"rgb(58, 58, 58)"}},m.replace(/<br><br>/g,"<br>").replace(/<br>/g,"\n"))),r.a.createElement("div",{className:"footer",style:{textAlign:"center"}},"News by ",r.a.createElement("a",{href:"https://github.com/summerscar/my-rss-node"},"summerscar"))):r.a.createElement("div",{className:"videoWrapper"},r.a.createElement("div",{className:"loading"},r.a.createElement(y.a,{size:"large"}),r.a.createElement("span",null,"\u7a0d\u7b49\u4e00\u4e0b\u54e6")))}));var Y=function(e){var t=Object(O.b)(),a=t.isAuthenticated,c=t.login,l=e.videos,o=e.isloading,i=Object(n.useRef)([]),s=Object(n.useContext)(R).channel;return r.a.createElement("div",{className:"homeWrapper"},l.length?l.map((function(e,t){return r.a.createElement("div",{key:t,className:"videoItem"},r.a.createElement("div",null,r.a.createElement("video",{ref:function(e){return i.current[t]=e},className:"videoRadius",src:e.url,width:"100%",controls:!0,preload:"none",poster:"image/".concat(s,".jpg")})),r.a.createElement(j.b,{className:"link",to:{pathname:"/video/"+e.id,state:{data:e}},onClick:function(){return e.id,e.title,void i.current.forEach((function(e){return e.pause()}))}},e.title,r.a.createElement("div",{style:{fontSize:"12px"}},S()(e.pubdate).format("YYYY/MM/DD HH:mm"))))})):o?r.a.createElement("div",{className:"loading"},r.a.createElement(y.a,{size:"large"}),r.a.createElement("span",null,"\u7a0d\u7b49\u4e00\u4e0b\u54e6")):null,l.length>0&&r.a.createElement(b.a,{size:"small",onClick:a()?e.more:c,loading:o},"\u66f4\u591a"),r.a.createElement(k.a,{path:"/video/:id"},r.a.createElement(M,null)))},F=f.a.Item;var V=Object(k.h)((function(e){var t=Object(n.useContext)(R).user,a=t&&(t["https://dev-ymyh-0n9:auth0:com/user_metadata"]&&t["https://dev-ymyh-0n9:auth0:com/user_metadata"].likes||t.user_metadata&&t.user_metadata.likes);return r.a.createElement("div",{className:"likes"},r.a.createElement("div",{style:{textAlign:"center",fontSize:"20px",padding:"1rem"}},"\u6536\u85cf\u5939"),r.a.createElement(f.a,{style:{margin:"0 1rem"}},a&&a.map((function(t,a){return r.a.createElement(F,{key:a,onClick:function(){return e.history.push("/video/"+t.id)}},S()(t.time).format("MM/DD HH:mm")+" "+t.title)}))))})),B=(a(212),a(111)),U=a.n(B),q=(a(63),a(46)),G=a.n(q),J=function(){var e=Object(O.b)(),t=e.isAuthenticated,a=e.login,c=e.authResult,l=e.user,o=Object(n.useContext)(R).setData;return console.log("user: ",c),Object(n.useEffect)((function(){o("user",l)}),[l]),t()?r.a.createElement("div",null,c&&(c.idTokenPayload.picture?r.a.createElement("img",{style:{marginRight:"0.5rem"},width:"20px",src:c.idTokenPayload.picture,alt:c.idTokenPayload.name}):r.a.createElement("span",{style:{paddingRight:"0.5rem"}},c.idTokenPayload.name)),r.a.createElement(y.a,{animating:!c})):r.a.createElement(b.a,{onClick:a,size:"small"},"\u767b\u5f55")},X=Object(k.h)((function(e){var t=Object(k.f)(),a=Object(n.useContext)(R),c=a.channel,l=a.channels;return console.log(c),r.a.createElement(U.a,{mode:"dark",icon:"/"===t.pathname?r.a.createElement(G.a,{key:"1",type:"ellipsis"}):r.a.createElement((function(){return r.a.createElement("svg",{t:"1583392599756",className:"am-icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2188",width:"32",height:"32"},r.a.createElement("path",{d:"M513.51198025 140.75069629l372.29605926 340.31186173c-18.95790618 2.32612345-36.75275062 10.11863704-50.9421037 22.56339754l-0.23261236 0.23261234-0.23261234 0.23261235c-13.7241284 12.21214816-30.00699261 33.72879011-30.00699258 67.57388642v316.934321H668.08288395V753.91683951c0-50.59318519-41.87022222-91.6492642-93.3938568-91.6492642H451.86970864c-51.52363457 0-93.39385678 41.17238519-93.39385679 91.6492642v134.56624197H223.79330373v-317.51585185c0-46.52246913-35.47338271-85.13611852-81.29801485-90.95142717l371.01669137-339.26510617m0-75.3664c-13.02629136 0-26.05258271 4.41963457-35.35707655 13.14259753L49.79926913 470.12977778c-15.35241481 13.14259754-19.77204938 32.91464691-11.51431111 50.9421037 8.25773827 17.5622321 25.81997038 27.91348148 46.05724444 27.91348148h46.05724444c13.14259754 0 23.61015309 9.88602469 23.6101531 21.86556049V912.09323457c0 25.23843951 22.44709136 46.05724444 49.89534815 46.05724444h174.45925924c27.44825678 0 49.89534815-20.81880494 49.89534816-46.05724444V753.91683951c0-12.09584198 10.46755556-21.86556049 23.61015309-21.8655605h122.81931851c13.14259754 0 23.61015309 9.88602469 23.6101531 21.8655605v158.29270123c0 25.23843951 22.44709136 46.05724444 50.47687901 46.05724445h174.45925926c28.02978766 0 51.05840989-20.81880494 51.05840988-46.05724445v-340.77708641c0-6.51314566 1.62828642-10.93278025 6.62945185-15.35241482 4.41963457-3.83810371 10.46755556-6.047921 16.98070124-6.047921H941.16977777c20.35358025 0 37.79950618-10.93278025 46.05724446-27.91348147 9.30449382-18.02745678 4.88485926-38.38103704-9.30449384-51.52363458L548.98536296 78.52689382c-9.30449382-8.72296296-22.44709136-13.14259754-35.47338271-13.14259753z",fill:"#ffffff","p-id":"2189"}))}),null),onLeftClick:"/"===t.pathname?e.openDock:function(){return e.history.push("/")},rightContent:[r.a.createElement(J,{key:"0"})]},r.a.createElement("div",null,l.find((function(e){return e.value===c})).label))})),$=function(){var e=Object(O.b)().handleAuthentication;return Object(n.useEffect)((function(){e()}),[e]),r.a.createElement("h1",null,"This is the auth callback page, you should be redirected immediately.")};var K=Object(k.h)((function(e){var t=Object(n.useState)([]),a=Object(g.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(0),s=Object(g.a)(o,2),m=s[0],h=s[1],v=Object(n.useState)(!1),b=Object(g.a)(v,2),E=b[0],y=b[1],j=Object(O.b)(),w=j.authResult,S=j.isAuthenticated,x=j.logout,C=j.login,N=Object(n.useState)(!1),I=Object(g.a)(N,2),_=I[0],A=I[1],P=Object(n.useState)("true"===localStorage.getItem("sequencePlay")),T=Object(g.a)(P,2),W=T[0],H=T[1],D=Object(n.useContext)(R),L=D.ytbPlayer,M=D.setData,F=D.channels,B=D.channel;Object(n.useEffect)((function(){S()?(y(!0),z.get("/api/auth/youtube/".concat(B,"?offset=").concat(m)).then((function(e){console.log(e.data),l((function(t){return[].concat(Object(p.a)(t),Object(p.a)(e.data.items))})),y(!1)}))):w||(y(!0),z.get("/api/youtube/".concat(B)).then((function(e){console.log(e.data),l(e.data.items),y(!1)})))}),[m,B]),Object(n.useEffect)((function(){w&&localStorage.setItem("accessToken",w.accessToken)}),[w]);var U=r.a.createElement(f.a,null,!S()&&r.a.createElement(f.a.Item,{onClick:C},"\u767b\u5f55"),r.a.createElement(f.a.Item,{onClick:function(){e.history.push("/likes"),A(!1)}},"\u6536\u85cf\u5939"),r.a.createElement(f.a.Item,{extra:r.a.createElement(d.a,{color:"#108ee9",checked:W,onChange:function(){H(!W),localStorage.setItem("sequencePlay",!W)}})},"\u8fde\u7eed\u64ad\u653e"),r.a.createElement(f.a.Item,{extra:r.a.createElement(d.a,{color:"#108ee9",checked:L,onChange:function(){M("ytbPlayer",!L),localStorage.setItem("ytbPlayer",!L)}})},"Youtube\u64ad\u653e\u5668"),r.a.createElement(u.a,{data:F,cols:1,value:[B],onChange:function(e){e=e[0],M("channel",e),localStorage.setItem("channel",e),l([]),h(0)}},r.a.createElement(f.a.Item,{arrow:"horizontal"},"\u5207\u6362\u9891\u9053")),S()&&r.a.createElement(f.a.Item,{onClick:function(){localStorage.removeItem("accessToken"),x()}},"\u6ce8\u9500"));return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"layout"},r.a.createElement(X,{openDock:function(){return A((function(e){return!e}))}}),r.a.createElement(i.a,{children:r.a.createElement(r.a.Fragment,null),className:"my-drawer",style:{pointerEvents:_?"auto":"none"},contentStyle:{color:"#A6A6A6",textAlign:"center",paddingTop:42},sidebar:U,open:_,onOpenChange:function(){return A((function(e){return!e}))}}),r.a.createElement("div",{className:"indexWrapper"},r.a.createElement(k.c,null,r.a.createElement(k.a,{path:"/likes"},r.a.createElement(V,null)),r.a.createElement(k.a,{path:"/"},r.a.createElement(Y,{videos:c,more:function(){return h((function(e){return e+4}))},isloading:E})))),r.a.createElement("div",{className:"footer",style:{textAlign:"center"}},"News by ",r.a.createElement("a",{href:"https://github.com/summerscar/my-rss-node"},"summerscar"))),r.a.createElement(k.a,{path:"/auth0_callback",component:$}))})),Q=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Z(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ee=Object(k.h)((function(e){return r.a.createElement(O.a,{navigate:e.history.push,auth0_domain:"dev-ymyh-0n9.auth0.com",auth0_client_id:"U9Ypez6umr0NvVSRxPfcTwEgj8WGIz6p",auth0_language:"zh",auth0_params:{scope:"openid profile email read:current_user update:current_user_metadata create:current_user_metadata"}},r.a.createElement(K,null))}));l.a.render(r.a.createElement(j.a,null,r.a.createElement((function(e){var t=e.children,a={root:{text:"hello context"},user:null,ytbPlayer:"true"===localStorage.getItem("ytbPlayer")||!1,channels:[{value:"ANNnewsCH",label:"ANN NEWS"},{value:"maidigitv",label:"MAiDiGiTV"}],channel:localStorage.getItem("channel")||"ANNnewsCH",setData:function(e,t){i((function(a){return Object(D.a)({},a,Object(H.a)({},e,t))}))},addStore:function(e,t){i((function(a){return Object(D.a)({},a,Object(H.a)({},e,t))}))}},c=Object(n.useState)(a),l=Object(g.a)(c,2),o=l[0],i=l[1];return r.a.createElement(R.Provider,{value:o},t)}),null,r.a.createElement(ee,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Q?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Z(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Z(t,e)}))}}()}},[[112,1,2]]]);
//# sourceMappingURL=main.02abc0e6.chunk.js.map